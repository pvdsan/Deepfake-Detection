# Facial DeepFake Detection

## Overview
Deepfake technology has become a critical challenge in the digital age, enabling the creation of deceptive digital content that can result in identity theft, reputational damage, and misinformation. This project aims to detect facial deepfakes using the **CelebDFv2 dataset**, employing two approaches:

1. **Feature Vector-Based Distance Metric Regression**
2. **Direct Face Crop EfficientNet Classifier**

The study evaluates detection efficacy through various performance metrics, including accuracy, loss, and Grad-CAM visualizations.

---

## Table of Contents

1. [Introduction](#introduction)
2. [Dataset](#dataset)
3. [Approaches](#approaches)
    - [Approach 1: Feature Vector Regression](#approach-1-feature-vector-regression)
    - [Approach 2: EfficientNet Classification and Grad-CAM](#approach-2-efficientnet-classification-and-grad-cam)
4. [Results](#results)
5. [Conclusion](#conclusion)
6. [References](#references)

---

## Introduction

Deepfake detection is crucial to combat the potential risks posed by hyper-realistic media generated by AI techniques such as Generative Adversarial Networks (GANs), Autoencoders, and StyleGAN. This project explores deepfake detection methods using machine learning and deep learning models to differentiate between authentic and manipulated media content.

---

## Dataset

We utilize the **CelebDFv2 dataset**, an improved version of CelebDFv1, known for its high-quality deepfake samples and diverse challenges that closely mimic real-world scenarios.

---

## Approaches

### Approach 1: Feature Vector Regression

1. **Steps:**
    - Extract frames from input video.
    - Detect and extract facial regions using **MTCNN (Multi-task Cascaded Convolutional Networks).**
    - Extract feature vectors using **InceptionResNet.**
    - Compute distances between feature vectors and a centroid reference.
    - Train a logistic regression model to classify videos as `REAL` or `FAKE`.

2. **Findings:**
    - This approach achieved a maximum validation accuracy of **54%**, with poor separability due to low resolution and compression artifacts in deepfakes.

---

### Approach 2: EfficientNet Classification and Grad-CAM

1. **Steps:**
    - Extract frames and detect faces using **MediaPipe**.
    - Classify images using **EfficientNet B0** to distinguish between deepfake and pristine samples.
    - Use **Grad-CAM** to highlight regions in the image influencing the classifier's decision.

2. **Findings:**
    - This approach achieved a **validation accuracy of 97%** and a **testing accuracy of 93%.**
    - Grad-CAM revealed that the stitched boundary between the real and fake face regions is the key indicator of deepfake manipulation.

---

## Results

- **Approach 1:** Struggled with low-quality images due to frame-to-frame pixel variations, making deepfake artifacts hard to distinguish.
- **Approach 2:** Demonstrated superior performance with minimal training (4 epochs), highlighting the effectiveness of CNN-based classification and interpretability using Grad-CAM.

---

## Conclusion

1. Distance-based methods are ineffective for low-quality images due to frame-to-frame pixel noise.
2. CNN-based approaches like EfficientNet, paired with Grad-CAM visualizations, offer high accuracy and better interpretability.
3. Future work should explore enhancing face extraction techniques and refining segmentation maps to improve model robustness.

---

## References

1. Tan, M., & Le, Q. (2019). **EfficientNet: Rethinking Model Scaling for Convolutional Neural Networks.**
2. Rossler, A., et al. (2019). **FaceForensics++: Learning to Detect Manipulated Facial Images.**
3. Dolhansky, B., et al. (2020). **The DeepFake Detection Challenge (DFDC) Preview Dataset.**
4. Thies, J., et al. (2016). **Face2Face: Real-time Face Capture and Reenactment of RGB Videos.**
5. Goodfellow, I., et al. (2014). **Generative Adversarial Networks.**

---

## How to Run

1. Clone the repository:
    ```bash
    git clone https://github.com/your-repo-name.git
    cd deepfake-detection
    ```
2. Install dependencies:
    ```bash
    pip install -r requirements.txt
    ```
3. Run the detection script:
    ```bash
    python detect_deepfake.py --input /path/to/video.mp4
    ```

---

## Acknowledgments
Special thanks to the Department of Computer Science, Georgia State University, for support and resources.

---

## License
This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

